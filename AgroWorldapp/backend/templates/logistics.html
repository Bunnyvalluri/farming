{% extends "base.html" %}

{% block content %}
<section class="py-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto min-h-screen">
  <div class="mb-16 text-center">
    <h2 class="text-4xl font-outfit font-extrabold text-slate-900 mb-4 flex items-center justify-center gap-4"
      data-key="log_title">
      <i class="fa-solid fa-gear text-primary-600/20 animate-spin-slow"></i>
      Logistics & Marketplace
      <i class="fa-solid fa-gear text-primary-600/20 animate-spin-reverse-slow"></i>
    </h2>
    <p class="text-slate-500 font-medium max-w-2xl mx-auto" data-key="log_desc">Skip the middlemen. Connect directly
      with verified suppliers
      and reliable transporters.</p>
  </div>

  <!-- Tabbed Navigation -->
  <div class="flex justify-center mb-16">
    <div class="inline-flex p-1.5 bg-slate-200/50 backdrop-blur-md rounded-[2rem] border border-slate-200">
      <button id="btnMfg" onclick="showTab('mfg')"
        class="tab-btn active px-8 py-3 rounded-full font-bold transition-all duration-300 flex items-center gap-2 group"
        data-key="tab_mfg">
        <i class="fa-solid fa-seedling group-hover:rotate-[360deg] transition-transform duration-700"></i>
        Seed Manufacturers
      </button>
      <button id="btnTrans" onclick="showTab('trans')"
        class="tab-btn px-8 py-3 rounded-full font-bold text-slate-500 hover:text-slate-700 transition-all duration-300 flex items-center gap-2 group"
        data-key="tab_trans">
        <i class="fa-solid fa-truck-fast group-hover:rotate-[360deg] transition-transform duration-700"></i>
        Transporters
      </button>
    </div>
  </div>

  <!-- Manufacturers Tab -->
  <div id="tabMfg" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
    <!-- Card 1 -->
    <div
      class="group bg-white rounded-[2.5rem] p-8 border border-slate-100 shadow-sm hover:shadow-2xl hover:-translate-y-2 transition-all duration-500 relative overflow-hidden">
      <div class="absolute top-0 right-0 p-8 opacity-[0.03] animate-spin-slow">
        <i class="fa-solid fa-leaf text-9xl"></i>
      </div>

      <div class="flex justify-between items-start mb-8">
        <div
          class="px-4 py-1 bg-emerald-50 text-emerald-700 rounded-full text-[10px] font-black uppercase tracking-widest border border-emerald-100 flex items-center gap-1.5">
          <i class="fa-solid fa-circle-check"></i> Verified
        </div>
        <div
          class="w-12 h-12 bg-primary-50 text-primary-600 rounded-2xl flex items-center justify-center text-xl shadow-lg shadow-primary-600/5">
          <i class="fa-solid fa-wheat-awn"></i>
        </div>
      </div>

      <h3
        class="text-2xl font-outfit font-extrabold text-slate-900 group-hover:text-primary-600 transition-colors mb-4">
        Krishi Seeds Ltd.</h3>
      <p class="text-slate-500 text-sm font-medium leading-relaxed mb-8">Leading producers of climate-resilient hybrid
        wheat and premium millet seeds.</p>

      <div class="space-y-4 pt-6 border-t border-slate-50 mb-8">
        <div class="flex items-center gap-4 text-slate-500 group-hover:text-slate-700 transition-colors">
          <i class="fa-solid fa-location-dot text-primary-600 w-5"></i>
          <span class="text-xs font-bold uppercase tracking-wider">Pune, Maharashtra</span>
        </div>
        <div class="flex items-center gap-4 text-slate-500 group-hover:text-slate-700 transition-colors">
          <i class="fa-solid fa-tags text-primary-600 w-5"></i>
          <span class="text-xs font-bold uppercase tracking-wider">Starting ₹450 <span class="text-slate-400">/
              50kg</span></span>
        </div>
      </div>

      <button onclick="openChat('Krishi Seeds')"
        class="w-full py-4 bg-primary-600 text-white rounded-2xl font-bold hover:bg-primary-700 shadow-lg shadow-primary-600/20 transition-all flex items-center justify-center gap-3">
        <i class="fa-solid fa-comment-dots"></i>
        <span data-key="btn_msg">Message Manufacturer</span>
      </button>
    </div>

    <!-- Card 2 -->
    <div
      class="group bg-white rounded-[2.5rem] p-8 border border-slate-100 shadow-sm hover:shadow-2xl hover:-translate-y-2 transition-all duration-500 relative overflow-hidden">
      <div class="absolute top-0 right-0 p-8 opacity-[0.03] animate-spin-reverse-slow">
        <i class="fa-solid fa-flask-vial text-9xl"></i>
      </div>

      <div class="flex justify-between items-start mb-8">
        <div
          class="px-4 py-1 bg-emerald-50 text-emerald-700 rounded-full text-[10px] font-black uppercase tracking-widest border border-emerald-100 flex items-center gap-1.5">
          <i class="fa-solid fa-circle-check"></i> Verified
        </div>
        <div
          class="w-12 h-12 bg-primary-50 text-primary-600 rounded-2xl flex items-center justify-center text-xl shadow-lg shadow-primary-600/5">
          <i class="fa-solid fa-droplet"></i>
        </div>
      </div>

      <h3
        class="text-2xl font-outfit font-extrabold text-slate-900 group-hover:text-primary-600 transition-colors mb-4">
        GreenGrow Fertilizers</h3>
      <p class="text-slate-500 text-sm font-medium leading-relaxed mb-8">Specializing in certified organic NPK and
        sustainable bio-fertilizers.</p>

      <div class="space-y-4 pt-6 border-t border-slate-50 mb-8">
        <div class="flex items-center gap-4 text-slate-500 group-hover:text-slate-700 transition-colors">
          <i class="fa-solid fa-location-dot text-primary-600 w-5"></i>
          <span class="text-xs font-bold uppercase tracking-wider">Nashik, Maharashtra</span>
        </div>
        <div class="flex items-center gap-4 text-slate-500 group-hover:text-slate-700 transition-colors">
          <i class="fa-solid fa-tags text-primary-600 w-5"></i>
          <span class="text-xs font-bold uppercase tracking-wider">Starting ₹1,200 <span class="text-slate-400">/
              unit</span></span>
        </div>
      </div>

      <button onclick="openChat('GreenGrow')"
        class="w-full py-4 bg-primary-600 text-white rounded-2xl font-bold hover:bg-primary-700 shadow-lg shadow-primary-600/20 transition-all flex items-center justify-center gap-3">
        <i class="fa-solid fa-comment-dots"></i>
        <span data-key="btn_msg">Message Manufacturer</span>
      </button>
    </div>
  </div>

  <!-- Transporters Tab (Initially Hidden) -->
  <div id="tabTrans" class="hidden grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
    <!-- Card 1 -->
    <div
      class="group bg-white rounded-[2.5rem] p-8 border border-slate-100 shadow-sm hover:shadow-2xl hover:-translate-y-2 transition-all duration-500 relative overflow-hidden">
      <div class="absolute top-0 right-0 p-8 opacity-[0.03] animate-spin-slow">
        <i class="fa-solid fa-truck text-9xl"></i>
      </div>

      <div class="flex justify-between items-start mb-8">
        <div
          class="px-4 py-1 bg-blue-50 text-blue-700 rounded-full text-[10px] font-black uppercase tracking-widest border border-blue-100 flex items-center gap-1.5">
          <i class="fa-solid fa-star"></i> Top Rated
        </div>
        <div
          class="w-12 h-12 bg-blue-50 text-blue-600 rounded-2xl flex items-center justify-center text-xl shadow-lg shadow-blue-600/5">
          <i class="fa-solid fa-truck"></i>
        </div>
      </div>

      <h3 class="text-2xl font-outfit font-extrabold text-slate-900 group-hover:text-blue-600 transition-colors mb-4">
        Ramesh Transport</h3>
      <p class="text-slate-500 text-sm font-medium leading-relaxed mb-8">Quick local delivery service using reliable
        mini trucks (Tata Ace, Mahindra Jeeto).</p>

      <div class="space-y-4 pt-6 border-t border-slate-50 mb-8">
        <div class="flex items-center gap-4 text-slate-500 group-hover:text-slate-700 transition-colors">
          <i class="fa-solid fa-weight-hanging text-blue-600 w-5"></i>
          <span class="text-xs font-bold uppercase tracking-wider">Capacity: 2 Tons</span>
        </div>
        <div class="flex items-center gap-4 text-slate-500 group-hover:text-slate-700 transition-colors">
          <i class="fa-solid fa-route text-blue-600 w-5"></i>
          <span class="text-xs font-bold uppercase tracking-wider">Rate: ₹15 <span class="text-slate-400">/
              km</span></span>
        </div>
      </div>

      <button onclick="openChat('Ramesh Transport')"
        class="w-full py-4 bg-blue-600 text-white rounded-2xl font-bold hover:bg-blue-700 shadow-lg shadow-blue-600/20 transition-all flex items-center justify-center gap-3">
        <i class="fa-solid fa-phone"></i>
        <span data-key="btn_contact">Contact Transporter</span>
      </button>
    </div>
  </div>

  <!-- Chat Modal Component -->
  <div id="chatModal" class="fixed bottom-8 right-8 w-full max-w-sm hidden z-[100] animate-[toastIn_0.4s_ease-out]">
    <div class="bg-white rounded-[2.5rem] shadow-2xl border border-slate-100 overflow-hidden flex flex-col h-[550px]">
      <!-- Chat Header -->
      <div class="bg-slate-900 text-white p-6 flex justify-between items-center shrink-0">
        <div class="flex items-center gap-4">
          <div class="relative">
            <div class="w-10 h-10 bg-primary-600 rounded-2xl flex items-center justify-center font-bold text-lg">A</div>
            <div class="absolute -top-1 -right-1 w-4 h-4 bg-emerald-500 border-4 border-slate-900 rounded-full"></div>
          </div>
          <div>
            <h4 id="chatTitle" class="font-outfit font-black leading-tight">Support</h4>
            <p class="text-[10px] text-emerald-400 font-bold uppercase tracking-widest">Active Now</p>
          </div>
        </div>
        <button onclick="document.getElementById('chatModal').classList.add('hidden')"
          class="w-8 h-8 rounded-full hover:bg-white/10 transition-colors flex items-center justify-center">
          <i class="fa-solid fa-times h-4"></i>
        </button>
      </div>

      <!-- Messages Area -->
      <div id="chatBox" class="grow bg-slate-50 p-6 overflow-y-auto flex flex-col gap-4 scroll-smooth">
        <div id="chatWelcome"
          class="bg-white p-4 rounded-2xl rounded-tl-none shadow-sm border border-slate-100 text-slate-600 text-sm font-medium max-w-[85%]">
          Namaste! How can we assist you with your farming needs today?
        </div>
      </div>

      <!-- Input Area -->
      <div class="p-4 bg-white border-t border-slate-100 shrink-0">
        <div class="flex gap-2">
          <input type="text" id="chatInput" placeholder="Write your message..."
            onkeydown="if(event.key === 'Enter') sendMessage()"
            class="grow px-4 py-3 bg-slate-50 border border-slate-200 rounded-2xl focus:ring-4 focus:ring-primary-100 focus:border-primary-500 transition-all outline-none text-sm font-medium">
          <button onclick="sendMessage()"
            class="w-12 h-12 bg-primary-600 text-white rounded-2xl flex items-center justify-center hover:bg-primary-700 transition-all shadow-lg shadow-primary-600/20">
            <i class="fa-solid fa-paper-plane text-sm"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
<script>
  function showTab(type) {
    const isMfg = type === 'mfg';
    document.getElementById('tabMfg').classList.toggle('hidden', !isMfg);
    document.getElementById('tabTrans').classList.toggle('hidden', isMfg);
    document.getElementById('tabTrans').classList.toggle('grid', !isMfg);

    const btnMfg = document.getElementById('btnMfg');
    const btnTrans = document.getElementById('btnTrans');

    if (isMfg) {
      btnMfg.className = "px-8 py-3 rounded-full font-bold transition-all duration-300 flex items-center gap-2 group bg-primary-600 text-white shadow-lg shadow-primary-600/20";
      btnTrans.className = "px-8 py-3 rounded-full font-bold text-slate-500 hover:text-slate-700 transition-all duration-300 flex items-center gap-2 group";
    } else {
      btnTrans.className = "px-8 py-3 rounded-full font-bold transition-all duration-300 flex items-center gap-2 group bg-blue-600 text-white shadow-lg shadow-blue-600/20";
      btnMfg.className = "px-8 py-3 rounded-full font-bold text-slate-500 hover:text-slate-700 transition-all duration-300 flex items-center gap-2 group";
    }
  }

  function openChat(name) {
    const modal = document.getElementById('chatModal');
    modal.classList.remove('hidden');
    document.getElementById('chatTitle').innerText = name;

    const welcomes = {
      'en': 'Namaste! How can we assist you with your logistics need today?',
      'hi': 'नमस्ते! ट्रांसपोर्ट या बीज के बारे में हम आज आपकी क्या मदद कर सकते हैं?',
      'te': 'నమస్తే! ఈ రోజు లాజిస్టిక్స్ పనుల్లో మేము మీకు ఎలా సహాయం చేయగలం?'
    };
    document.getElementById('chatWelcome').innerText = welcomes[currentLang] || welcomes['en'];
    document.getElementById('chatInput').focus();
  }

  function sendMessage() {
    const input = document.getElementById('chatInput');
    const msg = input.value.trim();
    if (!msg) return;

    const chatBox = document.getElementById('chatBox');

    // User Msg
    const userDiv = document.createElement('div');
    userDiv.className = "bg-primary-600 text-white p-4 rounded-2xl rounded-tr-none shadow-md text-sm font-bold self-end max-w-[85%] animate-[toastIn_0.3s_ease-out]";
    userDiv.innerText = msg;
    chatBox.appendChild(userDiv);

    input.value = '';
    chatBox.scrollTop = chatBox.scrollHeight;

    // Simulation of response
    setTimeout(() => {
      const replyText = currentLang === 'hi' ? "धन्यवाद, हमारी टीम जल्द ही आपसे संपर्क करेगी।" : "Thank you for your message. Our representative will get back to you within 15 minutes.";
      const replyDiv = document.createElement('div');
      replyDiv.className = "bg-white p-4 rounded-2xl rounded-tl-none shadow-sm border border-slate-100 text-slate-600 text-sm font-medium max-w-[85%] animate-[toastIn_0.3s_ease-out]";
      replyDiv.innerText = replyText;
      chatBox.appendChild(replyDiv);
      chatBox.scrollTop = chatBox.scrollHeight;
    }, 1200);
  }
</script>
<style>
  .tab-btn.active {
    pointer-events: none;
  }
</style>
{% endblock %}